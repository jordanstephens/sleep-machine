(this["webpackJsonpsleep-machine"]=this["webpackJsonpsleep-machine"]||[]).push([[0],{143:function(e,t,a){},149:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(56),c=a.n(o),i=(a(69),a(70),a(16)),s=a.n(i),l=a(36),u=a(1),m=(a(72),a(2)),d=a.n(m),h=(Math.PI,function(){}),v=function(e){return 50+e};var f=function(e){var t=e.beat;return r.a.createElement("svg",{viewBox:"0 0 ".concat(100," ").concat(100),className:"ProgressMeter"},[0,1,3,2].map((function(e,a){return r.a.createElement("rect",{key:e,className:d()({on:t===e}),x:a%2===0?0:52,y:a<2?0:52,height:48,width:48})})))},p=a(10),y=function(e){var t=e.className,a=Object(p.a)(e,["className"]);return r.a.createElement("svg",Object.assign({viewBox:"0 0 ".concat(100," ").concat(100),className:d()("Triangle",t)},a),r.a.createElement("polygon",{points:"0,".concat(100," ").concat(50,",0 ").concat(100,",").concat(100)}))},g=function(e){var t=e.className;return r.a.createElement("svg",{viewBox:"0 0 ".concat(100," ").concat(100),className:d()("Square",t)},r.a.createElement("rect",{x:0,y:0,height:100,width:100}))},b=function(e){var t=e.playing,a=e.onClick;return r.a.createElement("button",{onClick:a,className:"PlayPauseButton"},t?r.a.createElement(g,null):r.a.createElement(y,{style:{transform:"rotate(90deg)"}}))},E=a(12),w=a(57),x=a.n(w),k=a(14),N=(a(143),a(5)),j=a(7),O=a(11),M=a.n(O);function _(e,t,a){if(null==e)throw new Error("Invalid value");var n=Object(u.a)(t,2),r=n[0],o=n[1],c=Object(u.a)(a,2),i=c[0],s=c[1];if(r>=o)throw new Error("Invalid src Range: [".concat(r,", ").concat(o,"]"));if(i>=s)throw new Error("Invalid dst Range: [".concat(i,", ").concat(s,"]"));return(e-r)*(s-i)/(o-r)+i}function C(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length)return[];var t=M.a.sum(e);if(0===t)return e.map((function(e){return 0}));var a=[0,t],n=[0,1];return e.map((function(e){return _(e,a,n)}))}var S=function(){function e(t,a){Object(N.a)(this,e),this.a=void 0,this.b=void 0,this.a=t,this.b=a}return Object(j.a)(e,[{key:"equals",value:function(e){return this.a===e.a&&this.b===e.b||this.a===e.b&&this.b===e.a}},{key:"includes",value:function(e){return e===this.a||e===this.b}}]),e}(),D=function(){function e(t){Object(N.a)(this,e),this.weights=void 0,this.weights=t}return Object(j.a)(e,[{key:"chart",value:function(e){var t=this;return this.vertices.map((function(a){var n=360/t.order*a*Math.PI/180;return[e*Math.sin(n),-1*e*Math.cos(n),n]}))}},{key:"order",get:function(){return this.weights.length}},{key:"normalized_weights",get:function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length)return[];var t=Math.max.apply(Math,Object(E.a)(e)),a=[0,0===t?1:t],n=[0,1];return e.map((function(e){return _(e,a,n)}))}(this.weights)}},{key:"vertices",get:function(){return new Array(this.order).fill(0).map((function(e,t){return t}))}},{key:"edges",get:function(){var e=this;return M.a.chain(this.vertices).map((function(t){return e.vertices.map((function(e){return t!==e&&new S(t,e)}))})).flatten().compact().uniqBy((function(e){return[e.a,e.b].sort().join(":")})).value()}}]),e}(),T=a(24),L=a(23),B=a(25),P=r.a.createContext(null),q=function(e){var t=e.id,a=e.enabled,o=e.children;return a?r.a.createElement(P.Consumer,null,(function(e){if(!e)throw new Error("Invariant violation: DraggableContext.Consumer rendered without a context");return r.a.createElement("g",{onMouseDown:function(a){var n=a.clientX,r=a.clientY;e.setOrigin({id:t,x:n,y:r})}},o)})):r.a.createElement(n.Fragment,null,o)},z=function(e){function t(e){var a;return Object(N.a)(this,t),(a=Object(T.a)(this,Object(L.a)(t).call(this,e))).onMouseMove=function(e){a.handleDrag(!1,e)},a.onMouseUp=function(e){a.handleDrag(!0,e)},a.handleDrag=function(e,t){var n=a.props.onDrag;if(n){var r=a.state.origin;if(r){var o=r.id,c={x:t.clientX,y:t.clientY};n({id:o,origin:r,delta:{x:c.x-r.x,y:c.y-r.y},destination:c,committed:e}),e&&a.setState({origin:null})}}},a.state={origin:null},a}return Object(B.a)(t,e),Object(j.a)(t,[{key:"componentDidMount",value:function(){this.props.onDrag&&(document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousemove",this.onMouseMove))}},{key:"componentWillUnmount",value:function(){this.props.onDrag&&(document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove))}},{key:"render",value:function(){var e=this,t=this.props,a=t.children;if(!t.onDrag)return a;var n=this.state.origin;return r.a.createElement(P.Provider,{value:{origin:n,setOrigin:function(t){return e.setState({origin:t})}}},a)}}]),t}(r.a.Component);function F(e,t,a,n){if(0===a)return[e+n,t];if(a===1/0)return[e,t+n];var r=n*Math.sqrt(1/(1+Math.pow(a,2)));return[e+r,t+a*r]}var R,A=8,I=8,V=1.5,W=1,H=function(e){var t=e.id,a=e.p1,n=e.p2,o=e.weight,c=e.selected,i=function(e,t){var a=e.map(v),n=Object(u.a)(a,2),r=n[0],o=n[1],c=t.map(v),i=Object(u.a)(c,2),s=i[0],l=i[1],m=function(e,t,a,n){var r=a-e;return 0===r?1/0:(n-t)/r}(r,o,s,l),d=Math.sign(m),h=0===m&&s>r||m===1/0&&l>o||1===d&&s>r||-1===d&&s>r?[7,-7]:[-7,7],f=Object(u.a)(h,2),p=f[0],y=f[1],g=F(r,o,m,p),b=Object(u.a)(g,2),E=b[0],w=b[1],x=F(s,l,m,y),k=Object(u.a)(x,2);return[E,w,k[0],k[1]]}(a,n),s=Object(u.a)(i,4),l=s[0],m=s[1],h=s[2],f=s[3],p=Math.min(l,h),y=Math.min(m,f),g=p+(Math.max(l,h)-p)/2,b=y+(Math.max(m,f)-y)/2,E=g-A/2,w=b-I/2,x=[[g-V/2,b-I/2],[g,b-I/2-W],[g+V/2,b-I/2]].map((function(e){return e.join(",")})),k=[[g-V/2,b+I/2],[g,b+I/2+W],[g+V/2,b+I/2]].map((function(e){return e.join(",")}));return r.a.createElement("g",null,r.a.createElement("line",{x1:l,y1:m,x2:h,y2:f,className:d()("edge",{selected:!!c}),strokeLinecap:"round",markerEnd:c?"url(#selected-arrow)":"url(#arrow)"}),o&&r.a.createElement("g",{"data-index":t},r.a.createElement(q,{id:t,enabled:!0},r.a.createElement("rect",{x:E,y:w,width:A,height:I,className:"weight-box"}),r.a.createElement("text",{x:g,y:b,className:"weight-label",style:{fontSize:3,cursor:"ns-resize",userSelect:"none"},dominantBaseline:"middle",textAnchor:"middle"},"".concat((100*o).toFixed(0),"%")),r.a.createElement("polygon",{className:"edge-drag-triangle-up",points:x.join(" ")}),r.a.createElement("polygon",{className:"edge-drag-triangle-down",points:k.join(" ")}))))},U=function(e){var t=e.point,a=e.radius,n=e.weight,o=e.className,c=e.onClick,i=void 0===c?h:c,s=Object(u.a)(t,2),l=s[0],m=s[1];return r.a.createElement("circle",{cx:v(l),cy:v(m),r:a*n,className:d()("vertex",o),onClick:i})},X=function(e){var t=e.point,a=e.offset,n=e.size,o=e.text,c=Object(u.a)(t,2),i=c[0],s=c[1];return r.a.createElement("text",{x:v(i+Math.sign(i)*a),y:v(s+Math.sign(s)*a),textAnchor:"middle",dominantBaseline:"middle",className:"label",style:{fontSize:n}},o)},Y=function(e){var t=e.point,a=e.config,n=e.weight,o=e.label,c=e.className,i=e.onClick,s=e.onMouseEnter,l=e.onMouseLeave;return r.a.createElement("g",{onClick:i,onMouseEnter:s,onMouseLeave:l},r.a.createElement(X,{text:o||"",point:t,offset:a.label_offset,size:a.label_size}),r.a.createElement(U,{point:t,radius:a.point_radius,weight:1,className:"click-target"}),r.a.createElement(U,{point:t,radius:a.point_radius,weight:n,className:c}))},G={point_radius:R=5,label_offset:2*R,label_size:.8*R,graph_radius:33.33333},J=function(e){var t=e.labels,a=void 0===t?[]:t,n=e.weights,o=void 0===n?[]:n,c=e.onVertexMouseEnter,i=void 0===c?h:c,s=e.onVertexMouseLeave,l=void 0===s?h:s,m=e.onVertexClick,v=void 0===m?h:m,f=e.onWeightDrag,p=e.className,y=e.selected1,g=e.selected2,b=e.config,E=Object(k.a)({},b,{},G),w=new D(o),x=w.chart(E.graph_radius),N=w.normalized_weights;return r.a.createElement("div",{className:d()("WeightedGraph",p)},r.a.createElement(z,{onDrag:f},r.a.createElement("svg",{viewBox:"0 0 ".concat(100," ").concat(100)},r.a.createElement("defs",null,r.a.createElement("marker",{id:"arrow",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse",className:"edge-arrow"},r.a.createElement("path",{d:"M 0 0 L 10 5 L 0 10 z"})),r.a.createElement("marker",{id:"selected-arrow",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto-start-reverse",className:"edge-arrow selected"},r.a.createElement("path",{d:"M 0 0 L 10 5 L 0 10 z"}))),r.a.createElement("g",{style:{transform:"scale(1)",transformOrigin:"50% 50%"}},w.edges.map((function(e){var t=e.a,a=e.b,n=y===t?[t,a]:y===a?[a,t]:[],c=Object(u.a)(n,2),i=c[0],s=c[1];if(null==i||null==s)return null;var l=null==y?0:o[s];return 0===l?null:r.a.createElement(H,{key:"".concat(i,":").concat(s),id:String(s),p1:x[i],p2:x[s],weight:f&&l,selected:y===i&&g===s})})),x.map((function(e,t){return r.a.createElement(Y,{key:t,point:e,weight:y===t?1:N[t],label:a[t]||String(t),onClick:function(e){return v(t,e)},onMouseEnter:function(e){return i(t,e)},onMouseLeave:function(e){return l(t,e)},className:d()({selected1:y===t,selected2:g===t}),config:E})}))))))};var K=function(e){var t,a=e.current,o=void 0===a?0:a,c=e.next,i=e.weights,s=e.labels,l=e.onChange,m=(t=200,function(e,a){return e+a/(t=Math.max(t,Math.abs(a)))*(a>=0?1-e:e-0)}),h=i.map(C),v=Object(n.useState)(x()(h)),f=Object(u.a)(v,2),p=f[0],y=f[1],g=Object(n.useState)(null),b=Object(u.a)(g,2),w=b[0],k=b[1],N=Object(n.useState)(null),j=Object(u.a)(N,2),O=j[0],_=j[1],S=Object(n.useCallback)((function(e){_((function(t){return e===t?null:e}))}),[]);function D(e){k(e)}function T(){k(null)}Object(n.useEffect)((function(){function e(e){e.target&&(e.target.classList.contains("weight-label")||null!=O&&S(null))}return window.addEventListener("mousedown",e),function(){return window.removeEventListener("mousedown",e)}}),[S,O]);var L=null==O?w:O;return r.a.createElement("div",{className:"MarkovChart"},r.a.createElement(J,{labels:s,weights:i[o],className:d()("active",{fade:null!=L}),onVertexClick:function(e){O||S(e)},onVertexMouseEnter:D,onVertexMouseLeave:T,selected1:o,selected2:c}),null!=L&&r.a.createElement(J,{labels:s,weights:p[L],selected1:L,className:"selected",onVertexClick:S,onVertexMouseEnter:D,onVertexMouseLeave:T,onWeightDrag:function(e){if(null!=O){var t=parseInt(e.id,10),a=Object(E.a)(i[O]),n=a[t],r=e.delta.y,o=m(n,-1*r)-n;try{var c=function(e,t,a){if(t>e.length-1)throw new Error("index out of bounds");if(a<-1||a>1)throw new Error("delta out of bounds");if(e.length<2)throw new Error("vector length must be greater than 1");e.forEach((function(e){if(e<0||e>1)throw new Error("vector not normalized: value out of bounds")}));var n=M.a.sum(e);if(n<.99995||n>1+5e-5)throw new Error("vector not normalized: proportions sum to ".concat(n));var r=e[t],o=r+a;if(o<0||o>1)throw new Error("delta effect out of bounds");var c=n-r;if(0===c){var i=(n-o)/(e.length-1);return e.map((function(e,a){return a===t?o:i}))}return e.map((function(e,n){return n===t?o:e+-1*a*(e/c)}))}(a,t,o);p[O]=c,y(Object(E.a)(p))}catch(s){console.error(s)}e.committed&&l(Object(E.a)(p))}}}))},Z=a(63),$=function(e){var t=e.x,a=e.y,o=e.onChange,c=Object(p.a)(e,["x","y","onChange"]),i=Object(n.useState)(!1),s=Object(u.a)(i,2),l=s[0],m=s[1],d=Object(n.useState)({x:t,y:a}),h=Object(u.a)(d,2),v=h[0],f=h[1];return r.a.createElement("div",{style:{width:"y"!==c.axis?"100%":"auto",minHeight:"y"!==c.axis?"100px":void 0}},r.a.createElement(Z.a,Object.assign({},c,{x:l&&v.x?v.x:t,y:l&&v.y?v.y:a,onChange:function(e){f(e),o(e)},onDragStart:function(){return m(!0)},onDragEnd:function(){return m(!1)}})))},Q=function(e){var t=e.className;return r.a.createElement("svg",{viewBox:"0 0 ".concat(100," ").concat(100),className:d()("Circle",t)},r.a.createElement("circle",{cx:50,cy:50,r:50}))},ee=function(e){var t=e.className;return r.a.createElement("svg",{viewBox:"0 0 ".concat(100," ").concat(100),className:d()("Sawtooth",t)},r.a.createElement("polygon",{points:"0,".concat(100," ").concat(100,",0 ").concat(100,", ").concat(100)}))},te=function(e){var t=e.name,a=e.value,n=e.options,o=e.onChange;return r.a.createElement("div",{className:"RadioButtons"},n.map((function(e){var n=e.label,c=e.title,i=e.value;return r.a.createElement("div",{className:"RadioButton",key:i},r.a.createElement("input",{type:"radio",name:t,id:i,value:i,onChange:function(){return o(i)},checked:i===a}),r.a.createElement("label",{htmlFor:i,title:c},n))})))},ae="hsla(0, 0%, 0%, 0.4)",ne=[{value:"sine",title:"Sine",label:r.a.createElement(Q,{className:"waveform-icon"})},{value:"square",title:"Square",label:r.a.createElement(g,{className:"waveform-icon"})},{value:"triangle",title:"Triangle",label:r.a.createElement(y,{className:"waveform-icon"})},{value:"sawtooth",title:"Sawtooth",label:r.a.createElement(ee,{className:"waveform-icon"})}],re=[{value:"4t",label:"4t"},{value:"4n",label:"4"},{value:"8t",label:"8t"},{value:"8n",label:"8"}],oe=function(e){var t=e.params,a=e.onChange;return r.a.createElement("form",{className:"Controls"},r.a.createElement("fieldset",{className:"form-col waveform"},r.a.createElement("label",{className:"form-row",htmlFor:"waveform"},"Waveform"),r.a.createElement("div",{className:"form-row"},r.a.createElement(te,{name:"waveform",value:t.waveform,onChange:function(e){return a({waveform:e})},options:ne}))),r.a.createElement("fieldset",{className:"form-col envelope"},r.a.createElement("label",{className:"form-row",htmlFor:"envelope"},"Envelope"),r.a.createElement("div",{className:"form-row"},r.a.createElement("div",{className:"fader-bank"},r.a.createElement("div",{className:"fader-container"},r.a.createElement($,{axis:"y",y:t.attack,ymin:.01,ymax:1,ystep:.01,onChange:function(e){var t=e.y;return a({attack:t})},styles:{active:{background:"grey"},track:{background:ae,cursor:"move-y",height:"100px"}}}),r.a.createElement("label",{className:"fader-label"},"A")),r.a.createElement("div",{className:"fader-container"},r.a.createElement($,{axis:"y",y:t.decay,ymin:.01,ymax:1,ystep:.01,onChange:function(e){var t=e.y;return a({decay:t})},styles:{active:{background:"grey"},track:{background:ae,cursor:"move-y",height:"100px"}}}),r.a.createElement("label",{className:"fader-label"},"D")),r.a.createElement("div",{className:"fader-container"},r.a.createElement($,{axis:"y",y:t.sustain,ymin:.01,ymax:1,ystep:.01,onChange:function(e){var t=e.y;return a({sustain:t})},styles:{active:{background:"grey"},track:{background:ae,cursor:"move-y",height:"100px"}}}),r.a.createElement("label",{className:"fader-label"},"S")),r.a.createElement("div",{className:"fader-container"},r.a.createElement($,{axis:"y",y:t.release,ymin:.01,ymax:1,ystep:.01,onChange:function(e){var t=e.y;return a({release:t})},styles:{active:{background:"grey"},track:{background:ae,cursor:"move-y",height:"100px"}}}),r.a.createElement("label",{className:"fader-label"},"R")),r.a.createElement("div",{className:"fader-container"},r.a.createElement($,{axis:"y",y:t.width,ymin:.1,ymax:1,ystep:.1,onChange:function(e){var t=e.y;return a({width:t})},styles:{active:{background:"grey"},track:{background:ae,cursor:"move-y",height:"100px"}}}),r.a.createElement("label",{className:"fader-label"},"W"))))),r.a.createElement("fieldset",{className:"form-col delay"},r.a.createElement("label",{className:"form-row",htmlFor:"delay_wet"},"Delay"),r.a.createElement("div",{className:"form-row"},r.a.createElement($,{axis:"xy",x:t.delay_feedback,xmin:0,xmax:1,xstep:.01,y:t.delay_wet,ymin:0,ymax:1,ystep:.01,onChange:function(e){var t=e.x,n=e.y;return a({delay_feedback:t,delay_wet:n})},styles:{track:{background:ae,borderRadius:"4px",cursor:"move",height:"100px",width:"100%"}}}))),r.a.createElement("fieldset",{className:"form-col delay-time"},r.a.createElement("label",{className:"form-row",htmlFor:"delay_time"},"Delay Time"),r.a.createElement("div",{className:"form-row"},r.a.createElement(te,{name:"delay_time",value:t.delay_time,onChange:function(e){return a({delay_time:e})},options:re}))),r.a.createElement("fieldset",{className:"form-col chorus"},r.a.createElement("label",{className:"form-row",htmlFor:"chorus_frequency"},"Chorus"),r.a.createElement("div",{className:"form-row"},r.a.createElement($,{axis:"xy",x:t.chorus_frequency,xmin:0,xmax:20,xstep:.1,y:t.chorus_depth,ymin:0,ymax:1,ystep:.01,onChange:function(e){var t=e.x,n=e.y;return a({chorus_frequency:t,chorus_depth:n})},styles:{track:{background:ae,borderRadius:"4px",cursor:"move",height:"100px",width:"100%"}}}))))},ce=a(60),ie=a(61),se=a(144),le={tempo:90,waveform:"sine",attack:.01,decay:.5,sustain:.1,release:.5,delay_wet:.5,delay_time:"4n",delay_feedback:.33,chorus_frequency:4,chorus_delay_time:1.5,chorus_depth:.25,width:.1},ue=[0,4,7],me=[0,3,7],de=[ue,me,me,ue,ue,me,[0,3,6]],he=[0,2,4,5,7,9,11],ve=function(e,t){return Math.floor(Math.random()*(t-e)+e)},fe=function(e){function t(e){var a,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(N.a)(this,t),(a=Object(T.a)(this,Object(L.a)(t).call(this))).generators=void 0,a.probabilities=void 0,a.pattern=void 0,a.current=void 0,a.range=void 0,a.synth=void 0,a.updateParams=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(k.a)({},a.params,{},e);se.Transport.bpm.value=t.tempo,a.synth.update(t)},n=Object(k.a)({},le,{},n),a.synth=new ye(n),a.current=0,a.range=2,a.pattern=new pe(a.current,a.range),a.probabilities=[],a.generators=[],a.updateParams(n),a.updateProbabilities(e),se.Transport.latencyHint="playback",se.Transport.loop=!0,se.Transport.loopStart=0,se.Transport.loopEnd="1m",se.Transport.scheduleRepeat((function(e){se.Draw.schedule((function(){var e=a.next(a.current);a.emit("select",e,a.current),a.current=e}),e)}),"1:0:0","0:2:0"),se.Transport.scheduleRepeat((function(e){se.Draw.schedule((function(){a.pattern=new pe(a.current,a.range),a.emit("change",a.pattern,a.current)}),e)}),"1:0:0","0:0:0"),se.Transport.scheduleRepeat((function(e){se.Draw.schedule((function(){var e=se.Transport.position,t=parseInt(e.split(":")[1],10);a.emit("beat",t)}),e)}),"0:0:1","0:0:0"),se.Transport.scheduleRepeat((function(e){var t=ve(0,a.pattern.notes.length),n=a.pattern.notes[t];a.synth.trigger(n)}),"0:0:2","0:0:0"),a}return Object(B.a)(t,e),Object(j.a)(t,[{key:"updateProbabilities",value:function(e){this.probabilities=e,this.generators=e.map((function(e){return new ce.VoseAliasMethod(e)}))}},{key:"next",value:function(e){return this.generators[e].next()}},{key:"start",value:function(){"started"!==se.Transport.state&&se.Transport.start()}},{key:"stop",value:function(){se.Transport.stop()}},{key:"toggle",value:function(){se.Transport.toggle()}},{key:"params",get:function(){return{tempo:se.Transport.bpm.value,waveform:this.synth.voice.get("oscillator").oscillator.type,attack:this.synth.voice.get("envelope").envelope.attack,decay:this.synth.voice.get("envelope").envelope.decay,sustain:this.synth.voice.get("envelope").envelope.sustain,release:this.synth.voice.get("envelope").envelope.release,delay_wet:this.synth.delay.wet.value,delay_time:se.Time(this.synth.delay.delayTime.value).toNotation(),delay_feedback:this.synth.delay.feedback.value,chorus_frequency:this.synth.chorus.frequency.value,chorus_delay_time:this.synth.chorus.delayTime,chorus_depth:this.synth.chorus.depth,width:this.synth.width}}},{key:"state",get:function(){return se.Transport.state}}]),t}(ie.EventEmitter),pe=function e(t,a){Object(N.a)(this,e),this.notes=void 0;var n=48+he[t],r=de[t],o=new Array(a).fill(0).map((function(e,t){return t}));this.notes=M.a.flatten(o.map((function(e){return r.map((function(t){return n+t+12*e}))}))).map((function(e){return se.Frequency(e,"midi").toNote()}))},ye=function(){function e(t){Object(N.a)(this,e),this.delay=void 0,this.chorus=void 0,this.voice=void 0,this.width=void 0,this.width=t.width,this.delay=new se.PingPongDelay(t.delay_time,t.delay_feedback),this.delay.wet.value=t.delay_wet,this.chorus=new se.Chorus(t.chorus_frequency,t.chorus_delay_time,t.chorus_depth),this.voice=new se.PolySynth(4,se.Synth,{oscillator:{type:t.waveform}}),this.voice.set({envelope:{attack:t.attack,decay:t.decay,sustain:t.sustain,release:t.release}}),this.voice.chain(this.chorus,this.delay,se.Master)}return Object(j.a)(e,[{key:"update",value:function(e){this.width=e.width,this.voice.set({oscillator:{type:e.waveform},envelope:{attack:e.attack,decay:e.decay,sustain:e.sustain,release:e.release}}),this.delay.wet.value=e.delay_wet,this.delay.delayTime.value=e.delay_time,this.delay.feedback.value=e.delay_feedback,this.chorus.frequency.value=e.chorus_frequency,this.chorus.delayTime=e.chorus_delay_time,this.chorus.depth=e.chorus_depth}},{key:"trigger",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;this.voice.triggerAttackRelease(e,this.width,void 0,t)}}]),e}(),ge=a(15),be=a(62),Ee=a.n(be),we=38,xe=40,ke=function(e){var t,a=e.min,o=e.max,c=e.step,i=e.value,s=e.onChange,l=Object(p.a)(e,["min","max","step","value","onChange"]),m=function(e){return!isNaN(e)&&a<=e&&e<=o};if(!m(i))throw new Error('invalid value "'.concat(i,'"'));var d=Ee()(s),h=Object(n.useState)(i),v=Object(u.a)(h,2),f=v[0],y=v[1];function g(e){m(e)?(y(e),d(e)):y(i)}var b=(t={},Object(ge.a)(t,xe,(function(){var e=f-c;m(e)&&g(e)})),Object(ge.a)(t,we,(function(){var e=f+c;m(e)&&g(e)})),t);return r.a.createElement("input",Object.assign({},l,{type:"text",inputMode:"numeric",pattern:"[0-9]*",onBlur:function(e){var t=e.target;g(parseInt(t.value,10))},onChange:function(e){var t=e.target;y(Number(t.value))},onKeyDown:function(e){var t=b[e.keyCode];t&&t()},value:f}))},Ne=["C","D","E","F","G","A","B"],je=new fe([[0,.09,.06,.3,.4,.15,0],[.18,0,.13,.22,.22,.25,0],[.06,.1,0,.41,.1,.33,0],[.38,.06,.04,0,.38,.14,0],[.27,.07,.05,.27,0,.34,0],[.16,.09,.09,.36,.3,0,0],[.16,.16,.16,.16,.16,.16,0]]);var Oe=32,Me=function(){return window.screen.width<420||window.screen.height<420};function _e(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=Object(l.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.fullscreenEnabled&&Me()){e.next=2;break}return e.abrupt("return");case 2:return e.abrupt("return",t?document.documentElement.requestFullscreen():document.exitFullscreen());case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Se=function(){var e=function(e){var t=Object(n.useState)(!1),a=Object(u.a)(t,2),r=a[0],o=a[1],c=Object(n.useState)(0),i=Object(u.a)(c,2),s=i[0],l=i[1],m=Object(n.useState)(0),d=Object(u.a)(m,2),h=d[0],v=d[1],f=Object(n.useState)(void 0),p=Object(u.a)(f,2),y=p[0],g=p[1];return Object(n.useEffect)((function(){return e.on("select",(function(e,t){g(e)})).on("change",(function(e,t){g(void 0),v(t)})).on("beat",(function(e){l(e)})),function(){return e.stop()}}),[]),[s,h,y,r,function(e){o(e)}]}(je),t=Object(u.a)(e,5),a=t[0],o=t[1],c=t[2],i=t[3],m=t[4];function d(){return h.apply(this,arguments)}function h(){return(h=Object(l.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t="started"===je.state,m(!t),t){e.next=5;break}return e.next=5,_e(!0);case 5:if(je.toggle(),!t){e.next=9;break}return e.next=9,_e(!1);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(n.useEffect)((function(){function e(e){var t;if(null===(t=document.activeElement)||void 0===t||!t.classList.contains("PlayPauseButton"))return e.keyCode===Oe?d():void 0}return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[]),r.a.createElement("div",{className:"SleepMachine-container"},r.a.createElement("header",{className:"SleepMachine-header"},r.a.createElement("h1",{className:"wordmark"},r.a.createElement("span",null,"Zzz Machine"),r.a.createElement("br",null),r.a.createElement("small",null,r.a.createElement("em",null,"by ",r.a.createElement("a",{href:"https://twitter.com/jordanstephens"},"@jordanstephens"))," \u2022 ",r.a.createElement("a",{href:"https://github.com/jordanstephens/sleep-machine"},"Source"))),r.a.createElement("div",{className:"transport-controls-container"},r.a.createElement("div",{className:"transport-controls"},r.a.createElement("div",{className:"ProgressMeter-container"},i&&r.a.createElement(f,{beat:a})),r.a.createElement(ke,{id:"tempo",name:"tempo",min:60,max:180,step:1,value:Math.round(je.params.tempo),onChange:function(e){return je.updateParams({tempo:e})},className:"tempo-input"}),r.a.createElement("small",null,"bpm")))),r.a.createElement("main",{className:"App-main"},!i&&r.a.createElement("div",{className:"overlay"},r.a.createElement("div",{className:"start-message",onClick:d},r.a.createElement("div",{style:{marginBottom:"1rem",height:"3.5rem",width:"3.5rem"}},r.a.createElement(b,{playing:!1,onClick:function(){}})),"Play")),r.a.createElement("div",{className:"SleepMachine"},r.a.createElement("div",{className:"viz-container"},r.a.createElement("div",{className:"MarkovChart-container"},r.a.createElement(K,{labels:Ne,current:o,next:c,weights:je.probabilities,onChange:function(e){je.updateProbabilities(e)}}))),r.a.createElement("div",{className:"Controls-container"},r.a.createElement(oe,{beat:a,params:je.params,onChange:je.updateParams})))))};var De=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(Se,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(De,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},64:function(e,t,a){e.exports=a(149)},69:function(e,t,a){},70:function(e,t,a){},72:function(e,t,a){}},[[64,1,2]]]);
//# sourceMappingURL=main.6bd00e81.chunk.js.map